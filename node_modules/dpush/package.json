{
  "name": "dpush",
  "author": {
    "name": "Tomasz Janczuk",
    "email": "tomasz@janczuk.org",
    "url": "http://tomasz.janczuk.org"
  },
  "version": "0.2.0",
  "description": "Send push notifications to Android devices using GCM",
  "tags": [
    "azure",
    "sdk",
    "android",
    "notifications",
    "gcm",
    "push"
  ],
  "main": "./lib/dpush.js",
  "engines": {
    "node": ">= 0.6.20"
  },
  "licenses": [
    {
      "type": "Apache",
      "url": "http://www.apache.org/licenses/LICENSE-2.0"
    }
  ],
  "dependencies": {},
  "devDependencies": {
    "mocha": "1.7.0",
    "nock": "0.13.3"
  },
  "homepage": "https://github.com/tjanczuk/dpush",
  "repository": {
    "type": "git",
    "url": "git@github.com:tjanczuk/dpush.git"
  },
  "bugs": {
    "url": "http://github.com/tjanczuk/dpush/issues"
  },
  "scripts": {
    "test": "node node_modules/mocha/bin/mocha -u tdd -R list"
  },
  "readme": "dpush\n=====\n\nSend push notifications from a node.js application to an Android device using [Google Cloud Messaging](http://developer.android.com/google/gcm/index.html) (GCM).\n\n## What you need\n\n* Create a new Google API project following instructions from [here](http://developer.android.com/google/gcm/gs.html). The API key associated with the project is used as the `apiKey` parameter required by dpush. \n* Create an Android application and register it with GCM to receive notifications following instruction from [here](http://developer.android.com/google/gcm/gs.html). The device will be assigned a registration ID, which allows dpush to send notifications to the device. \n\n## Your first notification\n\nInstall ```dpush``` module with\n\n```\nnpm install dpush\n```\n\nThen send a notification to your Android application with:\n\n```javascript\nvar wns = require('dpush');\n\nvar registrationId = '{registration ID obtained by the Android application}';\nvar apiKey = '{API key associated with the Google API project}';\n\ndpush.send(apiKey, registrationId, 'Hello, world!', function (error, response) {\n    if (error)\n        console.error(error);\n    else\n        console.log(result);\n});\n```\n\nThe notification message can be extracted in your Android application as follows:\n\n```java\npublic class GCMIntentService extends GCMBaseIntentService {\n\n    @Override\n    protected void onMessage(Context context, Intent intent) {\n        String notificationMessage = intent.getStringExtra(\"message\");\n        // ...\n    }\n\n    // ...\n}\n```\n\nThe message parameter of the `dpush.send` API (Hello, world!) is optional. If not specified, the notification is still delivered but does not contain any paload. This can be used to signal the Android application, perhaps to perform a pull for data. \n\n## Sending multiple key value pairs\n\nYou can send a structured message with multiple key value pairs as follows:\n\n```javascript\nvar payload = {\n    symbol: 'msft',\n    price: '26.78',\n    lastClose: '26.20'  \n};\n\ndpush.send(apiKey, registrationId, payload, function (error, response) {\n    // ...\n});\n```\n\nThe values in the `payload` property bag must be strings. There are some restrictions on the property names outlined [here](http://developer.android.com/google/gcm/gcm.html#request). The total size of the payload serialized to JSON cannot be larger than 4KB. \n\nYou can extract individual values of the property bag in your Andoid application by passing the property name (e.g. `price`) to the `Intent.getStringExtra` API from within the overload of `GCMBaseIntentService.onMessage` API.\n\n## Sending uniform notifications to multiple recipients\n\nYou can send the same notification to multiple recipients with a single call to GCM as follows:\n\n```javascript\nvar registrationIds = [ '{registration ID 1}', '{registration ID 2}', ... ];\n\ndpush.send(apiKey, registrationIds, 'Hello, world!', function (error, response) {\n    // ...\n});\n```\n\n## Processing the response\n\nThe `dpush.send` API succeeds if GCM was able to successfuly accept the request. It does not mean all notifications were delivered. Your application must process the `response` callback parameter to fully understand the state of processing using instructions from [here](http://developer.android.com/google/gcm/gcm.html#response).\n\nThe `response` parameter contains the following two properties that the `dpush` module added to the response from GCM to help in processing the result:\n\n* `response.invalidIds` - this is an array of registration IDs that are no longer valid. The application should not send future notifications to these IDs, otherwise it may be blocked by GCM. \n* `response.updatedIds` - a map of registration IDs provided in the request to updated registration IDs. The application should use the updated IDs instead of the original IDs when sending future notifications. GCM may occasionally update the registration ID associated with a device, and this is the mechanism used to notify the sender about such update. \n\n## Advanced notifications\n\nIf you require any of the following advanced notification features, you must use the the `dpush.sendAdvanced` API instead of the `dpush.send` API:\n\n* automatically retry sending the notications if GCM servers are too busy,\n* collapse multiple notifications into one if the notification cannot be delievered at once,\n* only send a notification if the device is active,\n* specify the TTL for storing notifications at GCM servers while the device is offline,\n* restrict delivery to applications with specific package name,\n* issue the request against GCM sandbox without actual delivery to the device. \n\nThe `dpush.sendAdvanced` has the following signature:\n\n```\ndpush.sendAdvanced(apiKey, content, [retryCount], [callback])\n```\n\nThe `content` parameter is a JSON object passed verbatim as a request to the GCM service. Its format is specified [here](http://developer.android.com/google/gcm/gcm.html#request). \n\nThe `retryCount` is a non-negative integer indicating how many times the request should be re-tried if the GCM servers respond with a 5xx status code. The dpush module implements the required back-off policy based on the `Retry-After` HTTP response header sent from GCM. The default value is 0. \n\n## Running tests\n \nTests are using mocha and nock which are listed as dev dependencies. To run tests against the mocked up GCM responses:\n \n```\nnpm test\n```\n\nTo run tests against live GCM servers, update the dpush-tests.js file with your own Google API key and a sample, valid registration ID of an Android device, then:\n\n```\nexport NOCK_OFF=true (or set NOCK_OFF=true on Windows)\nnpm test\n```\n",
  "readmeFilename": "README.md",
  "_id": "dpush@0.2.0",
  "dist": {
    "shasum": "7f1d4128f01178a72066585531c9670d59eea482"
  },
  "_from": "dpush"
}
